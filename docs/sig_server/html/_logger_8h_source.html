<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>sigserver: Logger.h ソースファイル</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.3 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li class="current"><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>ファイル一覧</span></a></li>
      <li><a href="globals.html"><span>ファイルメンバ</span></a></li>
    </ul>
  </div>
<h1>Logger.h</h1><a href="_logger_8h.html">説明を見る。</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* $Id: _logger_8h_source.html,v 1.2 2011-12-14 07:55:37 okamoto Exp $ */</span> 
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef Logger_h</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define Logger_h</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;<a class="code" href="systemdef_8h.html">systemdef.h</a>&quot;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keyword">enum</span> {
<a name="l00010"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da50741f30286738bfb86b14e4764651c6">00010</a>     <a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da50741f30286738bfb86b14e4764651c6">LOG_ERRMSG</a> = 0,
<a name="l00011"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da96bb25c973dde470bb4b837c7522bfcd">00011</a>     <a class="code" href="_logger_8h.html#a6c04ef93b058ea3cd056768c47e0bcfb">LOG_SYSTEM</a>,
<a name="l00012"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da6aca8dedaa2e55070ed336ba4f167b26">00012</a>     <a class="code" href="_logger_8h.html#a868e6c1f422cabeab835fe2182ea3f8d">LOG_MSG</a>,
<a name="l00013"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da0839be90c02c83fe315c2ff2ffee3d39">00013</a>     <a class="code" href="_logger_8h.html#a3be31d30ea3387e1ec8e96eac0da8a7b">LOG_DEBUG1</a>,
<a name="l00014"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da9e4db63d3d5bff1ffb3565c8ec0c9332">00014</a>     <a class="code" href="_logger_8h.html#a9bee46861c4aba1aea2037138debb515">LOG_DEBUG2</a>,
<a name="l00015"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2daff593ad9fb9630cf8a580895ab591b72">00015</a>     <a class="code" href="_logger_8h.html#a83e691ea5753cff1081ff97bb40ea460">LOG_DEBUG3</a>,
<a name="l00016"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da0428418d27d8ed770672dacabfa867c6">00016</a>     <a class="code" href="_logger_8h.html#a60cb7dfd79afaf904277d4dd555ca4e2">LOG_DISPLAY</a>,   <span class="comment">//add by okamoto@tome (2011/8/3)</span>
<a name="l00017"></a><a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da87cff070224b283d7aace436723245fc">00017</a>     <a class="code" href="_logger_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da87cff070224b283d7aace436723245fc">LOG_ALL</a>,
<a name="l00018"></a>00018 };
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">/**</span>
<a name="l00021"></a>00021 <span class="comment"> * @brief ログクラス</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * 出力レベル、出力先の切り替え、複数の出力先の指定可能なログの実装。</span>
<a name="l00024"></a>00024 <span class="comment"> * シミュレーションサーバへのログの送信も可能。</span>
<a name="l00025"></a>00025 <span class="comment"> * このクラスを直接使用せず、マクロを介して使用すること。</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a><a class="code" href="class_logger.html">00027</a> <span class="keyword">class </span><a class="code" href="class_logger.html" title="ログクラス">Logger</a>
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029 <span class="keyword">public</span>:<span class="comment"></span>
<a name="l00030"></a>00030 <span class="comment">    //! 出力先抽象クラス</span>
<a name="l00031"></a><a class="code" href="class_logger_1_1_out_stream.html">00031</a> <span class="comment"></span>    <span class="keyword">class </span><a class="code" href="class_logger_1_1_out_stream.html" title="出力先抽象クラス">OutStream</a>
<a name="l00032"></a>00032     {
<a name="l00033"></a>00033     <span class="keyword">private</span>:
<a name="l00034"></a>00034         <span class="keywordtype">bool</span>    m_release;
<a name="l00035"></a>00035     <span class="keyword">protected</span>:
<a name="l00036"></a><a class="code" href="class_logger_1_1_out_stream.html#a29f8be6fa9e8925ec8c21f98fa4be803">00036</a>         <a class="code" href="class_logger_1_1_out_stream.html#a29f8be6fa9e8925ec8c21f98fa4be803">OutStream</a>() : m_release(true) {;}
<a name="l00037"></a><a class="code" href="class_logger_1_1_out_stream.html#a812dc6d959fd919819f6ee1d0e2d6128">00037</a>         <a class="code" href="class_logger_1_1_out_stream.html#a812dc6d959fd919819f6ee1d0e2d6128">OutStream</a>(<span class="keywordtype">bool</span> <a class="code" href="class_logger_1_1_out_stream.html#a6663fb7960756e1e09b3be95ee042b49">release</a>) : m_release(release) {;}
<a name="l00038"></a>00038     <span class="keyword">public</span>:
<a name="l00039"></a><a class="code" href="class_logger_1_1_out_stream.html#a1fc3294aef8f1b929756b565ccd25c03">00039</a>         <span class="keyword">virtual</span> <a class="code" href="class_logger_1_1_out_stream.html#a1fc3294aef8f1b929756b565ccd25c03">‾OutStream</a>() {;}
<a name="l00040"></a>00040 
<a name="l00041"></a>00041         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="class_logger_1_1_out_stream.html#a70028c5407eba86753316331fefc1df1">noHeader</a>() = 0;
<a name="l00042"></a>00042         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_logger_1_1_out_stream.html#a2b91802791201081f93d85bd5e5522f8">print</a>(<span class="keywordtype">int</span> level, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg) = 0;
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="class_logger_1_1_out_stream.html#a6663fb7960756e1e09b3be95ee042b49">00044</a>         <span class="keywordtype">bool</span> <a class="code" href="class_logger_1_1_out_stream.html#a6663fb7960756e1e09b3be95ee042b49">release</a>() { <span class="keywordflow">return</span> m_release; }
<a name="l00045"></a>00045     };
<a name="l00046"></a>00046 <span class="comment"></span>
<a name="l00047"></a>00047 <span class="comment">    //! ログリスナークラス</span>
<a name="l00048"></a><a class="code" href="class_logger_1_1_listener.html">00048</a> <span class="comment"></span>    <span class="keyword">class </span><a class="code" href="class_logger_1_1_listener.html" title="ログリスナークラス">Listener</a> : <span class="keyword">public</span> <a class="code" href="class_logger_1_1_out_stream.html" title="出力先抽象クラス">OutStream</a>
<a name="l00049"></a>00049     {
<a name="l00050"></a>00050     <span class="keyword">protected</span>:
<a name="l00051"></a><a class="code" href="class_logger_1_1_listener.html#a02e5982f6b59424310649dbcee5d7850">00051</a>         <a class="code" href="class_logger_1_1_listener.html#a02e5982f6b59424310649dbcee5d7850">Listener</a>() : <a class="code" href="class_logger_1_1_out_stream.html" title="出力先抽象クラス">OutStream</a>(false) {;}
<a name="l00052"></a>00052     <span class="keyword">private</span>:
<a name="l00053"></a>00053         <span class="keywordtype">bool</span> noHeader() { <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00054"></a>00054     };
<a name="l00055"></a>00055     
<a name="l00056"></a>00056 <span class="keyword">private</span>:
<a name="l00057"></a>00057     <span class="keyword">typedef</span> std::vector&lt;OutStream*&gt; C;
<a name="l00058"></a>00058 <span class="keyword">private</span>:
<a name="l00059"></a>00059     C   m_streams;
<a name="l00060"></a>00060     <span class="keywordtype">int</span> m_level;
<a name="l00061"></a>00061     <span class="keywordtype">int</span> m_outlevel;
<a name="l00062"></a>00062 <span class="keyword">private</span>:
<a name="l00063"></a>00063     <span class="keywordtype">void</span>    push(OutStream *o) { m_streams.push_back(o); }
<a name="l00064"></a>00064     <span class="keywordtype">void</span>    free_();
<a name="l00065"></a>00065 <span class="keyword">private</span>:
<a name="l00066"></a>00066     <a class="code" href="class_logger.html" title="ログクラス">Logger</a>() : m_level(<a class="code" href="_logger_8h.html#a868e6c1f422cabeab835fe2182ea3f8d">LOG_MSG</a>), m_outlevel(<a class="code" href="_logger_8h.html#a868e6c1f422cabeab835fe2182ea3f8d">LOG_MSG</a>) {;}
<a name="l00067"></a>00067 <span class="keyword">public</span>:<span class="comment"></span>
<a name="l00068"></a>00068 <span class="comment">    //! デストラクタ</span>
<a name="l00069"></a><a class="code" href="class_logger.html#ac58137065f210451a462579785f81368">00069</a> <span class="comment"></span>    <a class="code" href="class_logger.html#ac58137065f210451a462579785f81368" title="デストラクタ">‾Logger</a>() { free_(); }
<a name="l00070"></a>00070 <span class="keyword">public</span>:<span class="comment"></span>
<a name="l00071"></a>00071 <span class="comment">    //! 出力先に標準出力を追加</span>
<a name="l00072"></a>00072 <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a5be885a77f05cd1b894dfa6f21e18199" title="出力先に標準出力を追加">pushSTDOUT</a>();<span class="comment"></span>
<a name="l00073"></a>00073 <span class="comment">    //! 出力先にファイルを追加</span>
<a name="l00074"></a>00074 <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#ac23b6499bbaf3d6b935d79123313cf52" title="出力先にファイルを追加">pushFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname);<span class="comment"></span>
<a name="l00075"></a>00075 <span class="comment">    //! 出力先に転送先ソケットを追加</span>
<a name="l00076"></a>00076 <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a47aba1e14b1910c2c6cb9306113b3ad9" title="出力先に転送先ソケットを追加">pushSocket</a>(<a class="code" href="systemdef_8h.html#a8dc8083897335125630f1af5dafd5831">SOCKET</a>);<span class="comment"></span>
<a name="l00077"></a>00077 <span class="comment">    /**</span>
<a name="l00078"></a>00078 <span class="comment">     * @brief 出力先にリスナーを追加。</span>
<a name="l00079"></a>00079 <span class="comment">     *  リスナーの実装を行なうことで、任意の出力先へ出力が可能になる。</span>
<a name="l00080"></a>00080 <span class="comment">     */</span>
<a name="l00081"></a>00081     <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a57aecac87be1db82f492309a811424f3" title="出力先にリスナーを追加。 リスナーの実装を行なうことで、任意の出力先...">pushListener</a>(Listener *l);<span class="comment"></span>
<a name="l00082"></a>00082 <span class="comment">    //! 出力レベルの指定</span>
<a name="l00083"></a><a class="code" href="class_logger.html#a388f07f6220ab2bcc4057dd2e87fb941">00083</a> <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a388f07f6220ab2bcc4057dd2e87fb941" title="出力レベルの指定">setOutputLevel</a>(<span class="keywordtype">int</span> l) { m_outlevel = l; }<span class="comment"></span>
<a name="l00084"></a>00084 <span class="comment">    //! ログレベルの指定</span>
<a name="l00085"></a><a class="code" href="class_logger.html#a99ecbfe9499d15b49cc8dba77bdf3473">00085</a> <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a99ecbfe9499d15b49cc8dba77bdf3473" title="ログレベルの指定">setLevel</a>(<span class="keywordtype">int</span> l) { m_level = l; }<span class="comment"></span>
<a name="l00086"></a>00086 <span class="comment">    //! フォーマットを使用した出力メソッド</span>
<a name="l00087"></a>00087 <span class="comment"></span>    <span class="keywordtype">void</span>    <a class="code" href="class_logger.html#a0105e7ebfdcc80f8f7ccde9afe617051" title="フォーマットを使用した出力メソッド">print</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);
<a name="l00088"></a>00088 <span class="keyword">public</span>:<span class="comment"></span>
<a name="l00089"></a>00089 <span class="comment">    //! Loggerクラスインスタンスの取得(シングルトンパターン)</span>
<a name="l00090"></a>00090 <span class="comment"></span>    <span class="keyword">static</span> <a class="code" href="class_logger.html" title="ログクラス">Logger</a> &amp; <span class="keyword">get</span>();
<a name="l00091"></a>00091 };
<a name="l00092"></a>00092 
<a name="l00093"></a>00093    
<a name="l00094"></a><a class="code" href="_logger_8h.html#a84231c13e2d4b5961495d625a1112827">00094</a> <span class="preprocessor">#define LOG_STDOUT() Logger::get().pushSTDOUT()</span>
<a name="l00095"></a><a class="code" href="_logger_8h.html#ae74137e6d1c719d4c111e91a9f066dba">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_FILE(FNAME) Logger::get().pushFile(FNAME)</span>
<a name="l00096"></a><a class="code" href="_logger_8h.html#a844a48d79a0ed8ceae8ab543d9779e4b">00096</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_SOCKET(S) Logger::get().pushSocket(S)</span>
<a name="l00097"></a><a class="code" href="_logger_8h.html#ab6ca1c208a33e6282ce8cba58b1466ef">00097</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_LISTENER(S) Logger::get().pushListener(S)</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a><a class="code" href="_logger_8h.html#a0f2646b96fe58aa8c60c8548c1aa51f4">00099</a> <span class="preprocessor">#define LOG_OUTPUT_LEVEL(L) Logger::get().setOutputLevel(L)</span>
<a name="l00100"></a><a class="code" href="_logger_8h.html#ae618e332490bc98fec2990c9d48fc4ea">00100</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_LEVEL_MIN(A, B) ( (A) &lt; (B)? (A): (B) )</span>
<a name="l00101"></a><a class="code" href="_logger_8h.html#a055ce9bcd3d36c5910d7cf03c1be7260">00101</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_LEVEL_INCR(L, INCR) L = LOG_LEVEL_MIN(L + INCR, LOG_ALL)</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="_logger_8h.html#a53600e667c097ee1f85b9a96fe9e9f4c">00104</a> <span class="preprocessor">#define LOG_PRINT(L, MSG) { Logger &amp;l_ = Logger::get(); l_.setLevel(L); l_.print MSG; }</span>
<a name="l00105"></a>00105 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="_logger_8h.html#af6a7454396001c3d0416e82f34758b82">00106</a> <span class="preprocessor">#define LOG_ERR(MSG)    LOG_PRINT(LOG_ERRMSG, MSG)</span>
<a name="l00107"></a><a class="code" href="_logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">00107</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_ERROR   LOG_ERR</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00109"></a><a class="code" href="_logger_8h.html#a868e6c1f422cabeab835fe2182ea3f8d">00109</a> <span class="preprocessor">#define LOG_MSG(MSG)    LOG_PRINT(LOG_MSG, MSG)</span>
<a name="l00110"></a><a class="code" href="_logger_8h.html#a6c04ef93b058ea3cd056768c47e0bcfb">00110</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_SYSTEM(MSG) LOG_PRINT(LOG_SYSTEM, MSG)</span>
<a name="l00111"></a><a class="code" href="_logger_8h.html#aed3c19fdf7635d979eff473c9611926f">00111</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_SYS     LOG_SYSTEM</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00113"></a><a class="code" href="_logger_8h.html#a3be31d30ea3387e1ec8e96eac0da8a7b">00113</a> <span class="preprocessor">#define LOG_DEBUG1(MSG) LOG_PRINT(LOG_DEBUG1, MSG)</span>
<a name="l00114"></a><a class="code" href="_logger_8h.html#a9bee46861c4aba1aea2037138debb515">00114</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_DEBUG2(MSG) LOG_PRINT(LOG_DEBUG2, MSG)</span>
<a name="l00115"></a><a class="code" href="_logger_8h.html#a83e691ea5753cff1081ff97bb40ea460">00115</a> <span class="preprocessor"></span><span class="preprocessor">#define LOG_DEBUG3(MSG) LOG_PRINT(LOG_DEBUG3, MSG)</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a><a class="code" href="_logger_8h.html#a60cb7dfd79afaf904277d4dd555ca4e2">00117</a> <span class="preprocessor">#define LOG_DISPLAY(MSG) LOG_PRINT(LOG_DISPLAY, MSG)</span>
<a name="l00118"></a>00118 <span class="preprocessor"></span>
<a name="l00119"></a>00119 <span class="preprocessor">#endif // Logger_h</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span> 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>sigserverに対してWed Dec 14 14:29:18 2011に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
